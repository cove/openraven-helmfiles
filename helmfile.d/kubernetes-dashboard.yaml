repositories:
- name: kubernetes-dashboard
  url: https://kubernetes.github.io/dashboard/

releases:
{{ $ingHostname  := requiredEnv "OPENRAVEN_INGRESS_HOSTNAME" }}

- name: kubernetes-dashboard
  namespace: kube-system

  chart: kubernetes-dashboard/kubernetes-dashboard
  # https://github.com/kubernetes/dashboard/tree/master/aio/deploy/helm-chart/kubernetes-dashboard
  version: 2.2.0
  values:
  - fullnameOverride: 'kubernetes-dashboard'
  - ingress:
      enabled: true
      annotations:
        nginx.ingress.kubernetes.io/auth-url: "https://$host/oauth2/auth"
        nginx.ingress.kubernetes.io/auth-signin: "https://$host/oauth2/start?rd=$escaped_request_uri"
        nginx.ingress.kubernetes.io/rewrite-target: /$2
        nginx.ingress.kubernetes.io/backend-protocol: "HTTPS"
        nginx.ingress.kubernetes.io/auth-response-headers: "authorization"
      hosts:
        - {{ $ingHostname }}
      paths:
        - "/admin(/|$)(.*)"
  - metricsScraper:
      enabled: true
