controller:
  hostNetwork: true
  config:
    client-header-buffer-size: 64k
    x-error-log-levels: 'debug,info,notice,warn,error,crit,alert,emerg'
    error-log-level: info
    http2-max-field-size: 64k
    http2-max-header-size: 64k
    # http://nginx.org/en/docs/http/ngx_http_core_module.html#large_client_header_buffers
    large-client-header-buffers: 464k
    proxy-buffer-size: 64k
    ssl-buffer-size: 16k
    location-snippet: |
      # only if LB Proto is "http", not "tcp": if ($http_x_forwarded_proto = "http") {
      if ($scheme = "http") {
        return 301 https://$http_host$request_uri;
      }
    server-tokens: "false"
    x-ssl-ciphers-courtesy-of: https://managedkube.com/kubernetes/nginx/ingress/ssl/cipher/elb/hanging/2019/05/15/kubernetes-nginx-ingress-ssl-cipher-elb.html
    x-default-ssl-ciphers: ssl_ciphers 'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256';
    ssl-ciphers: "ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-DSS-AES128-GCM-SHA256:kEDH+AESGCM:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-DSS-AES128-SHA256:DHE-RSA-AES256-SHA256:DHE-DSS-AES256-SHA:DHE-RSA-AES256-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:AES:CAMELLIA:DES-CBC3-SHA:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!aECDH:!EDH-DSS-DES-CBC3-SHA:!EDH-RSA-DES-CBC3-SHA:!KRB5-DES-CBC3-SHA"
    x-proxy-real-ip-cidr: 10.128.0.0/16
    x-http-snippet: ""
    x-main-snippet: ""
    x-server-snippet: |
      location /show-me-what-you-got {
        default_type text/plain;
        content_by_lua_block {
          local source_url = "https://stackoverflow.com/questions/24380123/how-to-log-all-headers-in-nginx\n"
          source_url = source_url .. "$server_port(" .. ngx.var.server_port .. ")\n"
          source_url = source_url .. "$remote_addr(" .. ngx.var.remote_addr .. ")\n"
          source_url = source_url .. "$scheme(" .. ngx.var.scheme .. ")\n"
          local k
          local v
          for k, v in pairs(ngx.var) do
            source_url = source_url .. "VARIABLE(" .. k .. ") := <<" .. v .. ">>\n"
          end
          local h = ngx.req.get_headers()
          for k, v in pairs(h) do
            source_url = source_url .. "HEADER(" .. k .. ") := <<" .. v .. ">>\n"
          end
          ngx.say(source_url)
        }
      }
    x-use-proxy-protocol: "true"
    x-doc-url: https://github.com/kubernetes/ingress-nginx/blob/nginx-0.26.1/docs/user-guide/nginx-configuration/configmap.md#configuration-options

  dnsPolicy: ClusterFirstWithHostNet
  daemonset:
    useHostPort: true
  kind: DaemonSet
  tolerations:
  - operator: Exists
    effect: NoSchedule
    key: just-workers-for-now
  service:
    # only meaningful for type: LoadBalancer
    # externalTrafficPolicy: Local
    type: ClusterIP
  metrics:
    enabled: true

defaultBackend:
  serviceAccount:
    # don't do this, as of 1.26.2 it still tries to use "default-backend" and pukes
    # create: false
    create: true
  resources:
    limits:
      memory: 256Mi
